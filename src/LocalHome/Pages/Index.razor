@page "/"
@inherits IndexBase
@using LocalHome.Components;
@using Microsoft.AspNetCore.Hosting;
@using System.IO;

<Search OnFilter="DoFilter" />

@foreach (var ul in ULinkVM)
{
    <Link UserLink="@ul" />
}

@code{
    private List<UserLink> UserLinks { get; set; }
    private List<UserLinkViewModel> ULinkVM { get; set; }

    protected override void OnInitialized() {
        base.OnInitialized();
        UserLinks = GetUserLinks();
        ULinkVM = GetUserLinkViewModels();
    }

    private void DoFilter(ChangeEventArgs args) {
        Console.WriteLine($"inside Index.Razor->DoFilter: {args.Value}");
        string searchText = args.Value as string;

        if (string.IsNullOrWhiteSpace(searchText)) return;

        foreach(var ul in ULinkVM) {
            ul.Hidden = !IsMatch(ul.UserLink, searchText);
        }
    }

    private bool IsMatch(UserLink userLink, string searchText) {
        var strtosearch = $"{userLink.Text};{userLink.ImageUrl};{userLink.Url}";
        return strtosearch.Contains(searchText, StringComparison.OrdinalIgnoreCase);
    }
}




@*
    Links to consider for later on:
        https://simpleicons.org/
*@