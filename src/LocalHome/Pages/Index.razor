@page "/"
@inherits IndexBase
@using LocalHome.Components;
@using Microsoft.AspNetCore.Hosting;
@using System.IO;

<Search OnFilter="DoFilter" />

@if(ULinks != null && ULinks.Count > 0){
    @foreach (var ul in ULinks)
    {
        <Link UserLinkVM="@ul" />
    }
}
@code{
    private List<UserLinkViewModel> ULinks { get; set; }

    protected override async Task OnInitializedAsync()
    {
        ULinks = await GetUserLinkViewModels();
    }

    private void DoFilter(ChangeEventArgs args)
    {
        Console.WriteLine($"inside Index.Razor->DoFilter: {args.Value}");
        string searchText = args.Value as string;

        if (string.IsNullOrWhiteSpace(searchText)) return;

        foreach (var ul in ULinks)
        {
            ul.Hidden = !IsMatch(ul.UserLink, searchText);
        }
    }

    private bool IsMatch(UserLink userLink, string searchText)
    {
        var strtosearch = $"{userLink.Text};{userLink.ImageUrl};{userLink.Url}";
        return strtosearch.Contains(searchText, StringComparison.OrdinalIgnoreCase);
    }
}




@*
    Links to consider for later on:
        https://simpleicons.org/
        https://www.delta.com/us/en/check-in-security/overview
*@